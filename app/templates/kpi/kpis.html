{% extends "base.html" %}
{% block title %}KPI Index Page{% endblock %}
{% include "kpi/nav.html" %}
{% block page_content %}
<section class="section">
    <nav class="panel">
        <p class="panel-heading">
            <strong>ตารางตัวชี้วัด</strong>
        </p>
        <div class="panel-block">
            <table class="table is-narrow">
                <thead>
                    <tr>
                        <th>ลำดับที่</th>
                        <th>มาตรการ</th>
                        <th>กิจกรรม</th>
                        <th>ตัวชี้วัด</th>
                        <th>เป้าหมาย</th>
                        <th>ความถี่ในการประเมิน</th>
                        <th>ผู้รับผิดชอบ</th>
                        <th>ที่ปรึกษา</th>
                        <th>ผู้รายงาน</th>
                        <th>ผู้รับรายงาน</th>
                        <th>รายละเอียด</th>
                        <th>ข้อมูลตัวชี้วัด</th>
                    </tr>
                </thead>
                <tbody>
                {% for org in kpis.keys() %}
                {% if kpis[org]|length > 0 %}
                <tr>
                    <td colspan="13" class="is-light"><strong>{{ org }}</strong></td>
                </tr>
                    {% for kpi in kpis[org] %}
                    <tr>
                        <td>{{ loop.index }}</td>
                        <td>
                            {{ kpi.strategy_activity.theme.content }}
                        </td>
                        <td>
                            {{ kpi.strategy_activity.content }}
                        </td>
                        <td>
                            {{ kpi.name }}
                        </td>
                        <td>
                            {{ kpi.target }}
                        </td>
                        <td>
                            {{ kpi.frequency or 'ไม่ระบุ' }}
                        </td>
                        <td>
                            {{ kpi.account or 'ไม่ระบุ' }}
                        </td>
                        <td>
                            {{ kpi.consult or 'ไม่ระบุ' }}
                        </td>
                        <td>
                            {{ kpi.reporter or 'ไม่ระบุ' }}
                        </td>
                        <td>
                            {{ kpi.informed or 'ไม่ระบุ' }}
                        </td>
                        <td>
                            <a href="{{ url_for('kpi.edit', kpi_id=kpi.id )}}">
                                <span class="panel-icon">
                                    <i class="fa fa-info-circle"></i>
                                </span>
                            </a>
                        </td>
                        <td>
                            {% if kpi.reportlink %}
                            <a href="{{ kpi.reportlink }}">
                                <span class="icon has-text-info">
                                    <i class="fas fa-chart-line"></i>
                                </span>
                            </a>
                            {% else %}
                                <span class="icon has-text-light">
                                    <i class="fas fa-chart-line"></i>
                                </span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                {% endif %}
                {% endfor %}
                </tbody>
            </table>
        </div>
    </nav>
</section>
{% endblock %}