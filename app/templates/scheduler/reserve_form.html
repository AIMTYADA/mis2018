{% extends "base.html" %}
{% block title %}Add New Event{% endblock %}
{% block head %}
    {{ super() }}
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
{% endblock %}
{% include "scheduler/nav.html" %}
{% block page_content %}
<section class="section" id="app">
    <div class="columns">
        <div class="column">
            {% include "messages.html" %}
        </div>
    </div>
    <div class="columns">
        <div class="column is-two-thirds is-offset-2">
            <div class="box">
                <p class="has-text-centered">กรุณากรอกข้อมูลการจองห้องให้สมบูรณ์</p>
                {% if room.required_permission %}
                    <p class="has-text-danger">หมายเหตุ ท่านจะสามารถใช้ห้องนี้ได้หลังจากได้รับการอนุมัติแล้วเท่านั้น</p>
                {% endif %}
                <form method="post">
                    {{ form.hidden_tag() }}
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <label class="label">ห้อง</label>
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                    <input class="input is-static"
                                        name="number" type="text" value="{{ room.number }}">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <label class="label">วิทยาเขต</label>
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                    <input class="input is-static"
                                           name="location" type="text" value="{{ room.location }}">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <label class="label">ประเภทกิจกรรม</label>
                        </div>
                        <div class="field-body">
                            <div class="control">
                                <div class="field">
                                    <div class="select">
                                        {{ form.category() }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <label class="label">จุดประสงค์</label>
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                    {{ form.title(class='input is-danger', placeholder='จุดประสงค์') }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <label class="label">ตั้งแต่วันที่</label>
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                    {{ form.start(class='input') }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <label class="label">สิ้นสุดวันที่</label>
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                    {{ form.end(class='input') }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <label class="label">จำนวนผู้ใช้งาน</label>
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                    {{ form.occupancy(class='input') }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="field is-horizontal">
<!--                        <div class="field-label is-normal">-->
<!--                            <label class="label">อุปกรณ์ประจำ</label>-->
<!--                        </div>-->
                        <div class="field-body">
                            <div class="field is-grouped is-grouped-multiline">
                                {% for item in room.equipments %}
                                <div class="control">
                                    <div class="tags has-addons">
                                        <span class="tag is-dark is-medium">{{ loop.index }}</span>
                                        <span class="tag is-light is-medium">{{ item.th_name }}</span>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="field is-horizontal">
                        <div class="field-label is-normal">
                            <label class="label">ความต้องการเพิ่มเติม</label>
                        </div>
                        <div class="field-body">
                            <div class="field">
                                <div class="control">
                                    <textarea class="textarea" type="text" name="desc" rows="5"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="buttons is-centered">
                        <button type="submit" class="button is-success">
                            <strong>Submit</strong>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
{{super()}}
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
<script type="text/javascript">
    $('input[name="start"]').daterangepicker({
        singleDatePicker: true,
        timePicker: true,
        timePickerIncrement: 15,
        timePicker24Hour: true,
        buttonClasses: 'button is-small',
        applyButtonClasses: 'is-info',
        cancelButtonClasses: 'is-text',
        showDropdowns: true,
        {% if not form.start.data %}
        startDate: moment().startOf('hour'),
        {% else %}
            startDate: moment({{ form.start.data.isoformat()|tojson|safe }}).format('DD-MM-YYYY HH:mm:ss'),
        {% endif %}
        locale: {
            format: 'DD-MM-YYYY HH:mm:ss'
        }
    });
    $('input[name="end"]').daterangepicker({
        showDropdowns: true,
        singleDatePicker: true,
        timePicker: true,
        timePickerIncrement: 15,
        timePicker24Hour: true,
        buttonClasses: 'button is-small',
        applyButtonClasses: 'is-info',
        cancelButtonClasses: 'is-text',
        {% if not form.end.data %}
            startDate: moment().startOf('hour').add(1, 'hour'),
        {% else %}
            startDate: moment({{ form.end.data.isoformat()|tojson|safe }}).format('DD-MM-YYYY HH:mm:ss'),
        {% endif %}
        locale: {
            format: 'DD-MM-YYYY HH:mm:ss'
        }
    });
</script>
{% endblock %}