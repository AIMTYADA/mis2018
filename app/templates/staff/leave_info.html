{% extends "base.html" %}
{% include "staff/nav.html" %}
{% block page_content %}
<section class="section" id="app">
    <div class="container">
        <div class="columns">
            <div class="column is-offset-2 is-two-thirds">
        <h1 class="title">
            {% if line_profile %}
                <figure class="image is-64x64 is-inline-block">
                    <img class="is-rounded" src="{{ line_profile['pictureUrl'] }}">
                </figure>
            {% endif %}
            {{ current_user.personal_info }}
        </h1>
        <h4 class="subtitle">สถานะการจ้าง {{ current_user.personal_info.employment.title }}</h4>
            </div>
        </div>
        <div class="columns">
            <div class="column box is-offset-2 is-two-thirds">
        <table class="table is-fullwidth">
            <thead>
            <th>ประเภทการลา</th>
            <th>จำนวนวันลาที่ใช้</th>
            <th>จำนวนวันลาที่รออนุมัติ</th>
            <th>จำนวนวันลาที่ได้รับ</th>
            <th colspan="2">ขออนุมัติ</th>
            </thead>
            <tbody>
            {% for type,quota in quota_days.iteritems() %}
            <tr>
                <td>
                    <b-tooltip label="คลิ๊กเพื่อดูประวัติ" type="is-light">
                    <a href="{{ url_for('staff.request_for_leave_info', quota_id=quota.id) }}">
                       {{ type }}
                    </a>
                    </b-tooltip>
                </td>
                <td style="color:grey">{{ cum_days[type] }}</td>
                <td style="color:#BF740F">{{ pending_days[type] }}</td>
                <td style="color:green">{{ quota.limit }}</td>
                {% if quota.limit - cum_days[type] > 0 %}
                <td><a class="button is-rounded is-info is-light" href="{{ url_for('staff.request_for_leave', quota_id=quota.id) }}">ลาเต็มวัน</a>
                <a class="button is-rounded is-warning is-light" href="{{ url_for('staff.request_for_leave_period', quota_id=quota.id) }}">ลาครึ่งวัน</a>
                </td>
                {% else %}
                <td>วันลาเต็ม</td>
                {% endif %}
            </tr>
            {% endfor %}
            </tbody>
        </table>
        {% if approver %}
        <a href="{{ url_for('staff.show_leave_approval_info') }}" class="button is-link">สำหรับหัวหน้างาน</a>
        {% endif %}
        </div>
        </div>
        <div class="has-text-centered">
            <span>พบปัญหาเกี่ยวกับระบบ
                <br>ติดต่อ napatsakorn.pis@mahidol.ac.th หรือโทรศัพท์ภายใน 2845
            </span>
        </div>
    </div>
    </div>
</section>
<section class="section">
    <div class="container">
        <div class="columns">
            <div class="column is-two-thirds is-offset-2">
                <h1 class="title is-size-4">วิดีโอสาธิตการใช้งานระบบลาออนไลน์</h1>
                <div class="box">
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/RkVng_7uEJo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}
{% block scripts %}
{{ super() }}
<script>
    new Vue({
        el: '#app',
    });
</script>
{% endblock %}
